<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>Bingo Menu</title>
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=BBH+Sans+Hegarty&display=swap" rel="stylesheet">
<style>
body {
    user-select: none;
    margin: 0;
    padding: 0;
    background: #000;
    height: 100vh;
    display: flex;
    justify-content: center;
    align-items: center;
    font-family: Arial, sans-serif;
}

#menuBlock {
    width: 450px;
    padding: 30px;
    border: 3px solid white;
    background: #000000;
    text-align: center;
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 20px;
    box-sizing: border-box;
    border-radius: 50px;
}

#menuBlock h1 {
    font-size: 50px;
    font-weight: bold;
    font-family: "BBH Sans Hegarty", sans-serif;
    color: rgb(18, 182, 68);
    padding-bottom: 60px;
}

.menu-btn {
    width: 80%;
    padding: 20px;
    border-radius: 50px;
    background: white;
    color: black;
    border: solid;
    font-size: 20px;
    cursor: pointer;
    transition: transform 0.2s;
}

.menu-btn:hover {
    transform: scale(1.05);
    background-color: black;
    color: white;
}

.menu-link {
    padding-top: 50px;
    color: gray;
    text-decoration: underline;
    cursor: pointer;
    font-size: 20px;
}
.menu-link:hover {
   color: rgb(18, 182, 68);
}

/* Multiplayer submenu */
#multiOptions {
    display: none;
    flex-direction: column;
    gap: 15px;
    margin-top: 10px;
    width: 100%;
    align-items: center;
    justify-content: center;
    text-align: center;
}

#multiOptions button {
    width: 80%;
    padding: 15px;
    border-radius: 50px;
    background: white;
    color: black;
    border: solid;
    font-size: 18px;
    cursor: pointer;
    transition: transform 0.2s;
}
#multiOptions button:hover {
    transform: scale(1.05);
    background-color: black;
    color: white;
}

/* Mobile adjustments */
@media (max-width: 480px) {
    #menuBlock {
        width: 90%;
        padding: 20px;
        gap: 15px;
    }
    #menuBlock h1 {
        font-size: 32px;
    }
    .menu-btn, #multiOptions button {
        font-size: 16px;
        padding: 12px;
    }
    .menu-link {
        font-size: 14px;
    }
    * {
      -webkit-tap-highlight-color: transparent;
    }
    button:focus,
    button:active {
      outline: none;
      box-shadow: none;
    }
    button {
      -webkit-appearance: none;
      -moz-appearance: none;
      appearance: none;
    }
}
.menu-btn.inverted {
    background-color: black;
    color: white;
    border-color: white;
}
.room-input {
    width: 80%;
    padding: 20px;
    border-radius: 50px;
    background: white;
    color: black;
    border: solid 2px;
    font-size: 26px;
    text-align: center;
    outline: none;
    transition: all 0.25s ease;
    font-family: monospace; /* makes numbers evenly spaced */
    letter-spacing: 20px;   /* BIG spacing */
    box-sizing: border-box;
    caret-color: rgb(18,182,68); /* green cursor */
}




</style>
</head>
<body>

<audio id="soundclick" src="hover.wav"></audio>



<div id="menuBlock">
    <h1>BINGO</h1>

    <!-- Main Play button -->
    <button class="menu-btn" id="multiBtn">Play</button>

    <!-- Multiplayer / Solo options -->
    <div id="multiOptions">
        <button id="createRoomBtn">Create Room</button>
        <button id="joinRoomBtn">Join Room</button>
        <button id="soloBtn">Solo</button>
    </div>

    <div class="menu-link" onclick="howToPlay()">How To Play</div>
</div>
<script src="/socket.io/socket.io.js"></script>
<script>
const pat = document.getElementById("soundclick");
pat.volume = 0.04;

// Enable audio on first click (Chrome fix)
document.addEventListener("click", () => {
    pat.play().catch(() => {});
}, { once: true });

function playpat() {
    pat.currentTime = 0;
    pat.play().catch(() => {});
}

// Elements
const multiBtn = document.getElementById("multiBtn");
const multiOptions = document.getElementById("multiOptions");
const createBtn = document.getElementById("createRoomBtn");
const joinBtn = document.getElementById("joinRoomBtn");
const soloBtn = document.getElementById("soloBtn");

// Toggle submenu
multiBtn.addEventListener("click", () => {
    const isOpen = multiOptions.style.display === "flex";
    if (isOpen) {
        multiOptions.style.display = "none";
        multiBtn.textContent = "Play";
        multiBtn.classList.remove("inverted");
    } else {
        multiOptions.style.display = "flex";
        multiBtn.textContent = "â†";
        multiBtn.classList.add("inverted");
    }
});

// Solo: go to index.html
soloBtn.addEventListener("click", () => {
    setTimeout(() => {
        window.location.href = "index.html";
    }, 300);
});

// Socket connection
const socket = io(); // connect to server

// -------------------
// CREATE ROOM
// -------------------
// Create Room button
createBtn.addEventListener("click", () => {
    socket.emit("requestRoom"); // tell server: "make me new room"
});


// Join Room stays the same, just navigates with ?room=XXX


// Listen for room creation confirmation
socket.on("roomCreated", (code) => {
    window.location.href = `multiplayer.html?room=${code}`;
});


// -------------------
// JOIN ROOM
// -------------------
joinBtn.addEventListener("click", () => {
    const input = document.createElement("input");
    input.type = "tel";
    input.inputMode = "numeric";   // mobile numeric keyboard
    input.pattern = "[0-9]*";
    input.maxLength = 3;
    input.placeholder = "___";
    input.classList.add("room-input");

    input.style.width = joinBtn.offsetWidth + "px";
    input.style.height = joinBtn.offsetHeight + "px";

    joinBtn.style.opacity = "0";
    setTimeout(() => {
        joinBtn.replaceWith(input);
        input.focus();
    }, 150);

    // Only allow digits
    input.addEventListener("input", () => {
        input.value = input.value.replace(/\D/g, "");
    });

    // Submit on enter when 3 digits typed
    input.addEventListener("keydown", (e) => {
        if (e.key === "Enter" && input.value.length === 3) {
            const code = input.value;
            socket.emit("joinRoom", code); // tell server to join this room
        }
    });

    // Click outside â†’ revert
    setTimeout(() => {
        document.addEventListener("click", function revert(e) {
            if (e.target !== input) {
                input.replaceWith(joinBtn);
                joinBtn.style.opacity = "1";
                document.removeEventListener("click", revert);
            }
        });
    }, 200);
});

// Listen for successful join
socket.on("roomJoined", ({ code }) => {
    console.log("Joined room:", code);
    window.location.href = `multiplayer.html?room=${code}`;
});

// Error handling
socket.on("roomNotFound", () => alert("âŒ Room not found!"));
socket.on("roomFull", () => alert("ðŸš« Room full!"));

// Hover sound
[multiBtn, multiOptions, createBtn, joinBtn, soloBtn].forEach(el => {
    el.addEventListener("mouseenter", () => playpat());
});

// How to Play
function howToPlay() {
    setTimeout(() => {
        window.location.href = "How-to-play.html";
    }, 300);
}

</script>

</body>
</html>
